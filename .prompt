#!/bin/bash

__prompt_normal="\001$(tput sgr0)\002"
__prompt_red="\001$(tput setaf 1)\002"
__prompt_green="\001$(tput setaf 2)\002"
__prompt_yellow="\001$(tput setaf 3)\002"
__prompt_bold="\001$(tput bold)\002"

__prompt_is_root()
{
    [ "$(id -u)" -eq 0 ]
}

__prompt_user_char()
{
    if __prompt_is_root; then printf "#"; else printf "$"; fi
}

__prompt_cwd()
{
  printf "${__prompt_bold}$PWD${__prompt_normal}"
}

__prompt_hostname()
{
  printf "${__prompt_green}$HOSTNAME${__prompt_normal}"
}

__prompt_current_user()
{
  printf "${__prompt_red}$USER${__prompt_normal}"
}

__prompt_git_dirty()
{
  local dirty=$(git status --porcelain 2> /dev/null)
  if [[ -n $dirty ]]; then
    printf "*"
  fi
}

__prompt_current_git_branch()
{
  local branch=$(git branch --no-color --show-current 2>/dev/null)
  if [[ -n $branch ]]; then
    printf " ${__prompt_yellow}${branch}${__prompt_normal}$(__prompt_git_dirty)"
  fi
}

function prompt_init_ps1
{
  PS1=''
  PS1+='[$(__prompt_current_user)'
  PS1+='@'
  PS1+='$(__prompt_hostname) '
  PS1+='$(__prompt_cwd)'
  PS1+='$(__prompt_current_git_branch)]'
  PS1+='$(__prompt_user_char) '
}
